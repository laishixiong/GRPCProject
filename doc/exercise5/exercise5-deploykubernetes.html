<!DOCTYPE html>
<!-- saved from url=(0082)https://retroryan8080.gitlab.io/grpc-java-workshop/exercise5/deploykubernetes.html -->
<html class=" js flexbox canvas canvastext webgl no-touch geolocation postmessage websqldatabase indexeddb hashchange history draganddrop websockets rgba hsla multiplebgs backgroundsize borderimage borderradius boxshadow textshadow opacity cssanimations csscolumns cssgradients cssreflections csstransforms csstransforms3d csstransitions fontface generatedcontent video audio localstorage sessionstorage webworkers no-applicationcache svg inlinesvg smil svgclippaths" lang="en" style=""><!--<![endif]--><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
  
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Deploy a Kubernetes Cluster — gRPC Chatroom Workshop  documentation</title>
  

  
  
  
  

  

  
  
    

  

  <link rel="stylesheet" href="./exercise5-deploykubernetes_files/custom.css" type="text/css">
  <link rel="stylesheet" href="./exercise5-deploykubernetes_files/pygments.css" type="text/css">
    <link rel="index" title="Index" href="https://retroryan8080.gitlab.io/grpc-java-workshop/genindex.html">
    <link rel="search" title="Search" href="https://retroryan8080.gitlab.io/grpc-java-workshop/search.html">
    <link rel="next" title="Using Kubernetes Services" href="https://retroryan8080.gitlab.io/grpc-java-workshop/exercise5/usingservices.html">
    <link rel="prev" title="Google Cloud Console Setup" href="https://retroryan8080.gitlab.io/grpc-java-workshop/exercise5/setup.html"> 

  
  <script src="./exercise5-deploykubernetes_files/modernizr.min.js.download"></script><style type="text/css">
:root .btn[href*="/viphktv.com/"],
:root .btn[href*=".papa9394.com"],
:root .btn.btn-success.text-white[href*=".com:"]
{ display: none !important; }</style>

</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="https://retroryan8080.gitlab.io/grpc-java-workshop/index.html" class="icon icon-home"> gRPC Chatroom Workshop
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="https://retroryan8080.gitlab.io/grpc-java-workshop/search.html" method="get">
    <input type="text" name="q" placeholder="Search docs">
    <input type="hidden" name="check_keywords" value="yes">
    <input type="hidden" name="area" value="default">
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="https://retroryan8080.gitlab.io/grpc-java-workshop/setup/setup.html">Setup</a></li>
<li class="toctree-l1"><a class="reference internal" href="https://retroryan8080.gitlab.io/grpc-java-workshop/exercise1/exercise1.html">Exercise 1 - Basics</a></li>
<li class="toctree-l1"><a class="reference internal" href="https://retroryan8080.gitlab.io/grpc-java-workshop/exercise2/exercise2.html">Exercise 2 - Implement Stubs</a></li>
<li class="toctree-l1"><a class="reference internal" href="https://retroryan8080.gitlab.io/grpc-java-workshop/exercise3/exercise3.html">Exercise 3 - Testing the Client</a></li>
<li class="toctree-l1"><a class="reference internal" href="https://retroryan8080.gitlab.io/grpc-java-workshop/exercise4/exercise4.html">Exercise 4 - Bidirectional Streaming</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="https://retroryan8080.gitlab.io/grpc-java-workshop/exercise5/exercise5.html"><span class="toctree-expand"></span>Exercise 5 - Deployment to Kubernetes</a><ul class="">
<li class="toctree-l2"><a class="reference internal" href="https://retroryan8080.gitlab.io/grpc-java-workshop/exercise5/setup.html">Google Cloud Console Setup</a></li>
<li class="toctree-l2 current"><a class="reference internal current" href="https://retroryan8080.gitlab.io/grpc-java-workshop/exercise5/deploykubernetes.html#"><span class="toctree-expand"></span>Deploy a Kubernetes Cluster</a><ul>
<li class="toctree-l3"><a class="reference internal" href="https://retroryan8080.gitlab.io/grpc-java-workshop/exercise5/deploykubernetes.html#set-default-region-and-zones">Set Default Region and Zones</a></li>
<li class="toctree-l3"><a class="reference internal" href="https://retroryan8080.gitlab.io/grpc-java-workshop/exercise5/deploykubernetes.html#configure-your-default-project">Configure your Default Project</a></li>
<li class="toctree-l3"><a class="reference internal" href="https://retroryan8080.gitlab.io/grpc-java-workshop/exercise5/deploykubernetes.html#enable-compute-engine-and-kubernetes-engine-api">Enable Compute Engine and Kubernetes Engine API</a></li>
<li class="toctree-l3"><a class="reference internal" href="https://retroryan8080.gitlab.io/grpc-java-workshop/exercise5/deploykubernetes.html#create-a-kubernetes-cluster-using-the-google-kubernetes-engine">Create a Kubernetes Cluster using the Google Kubernetes Engine</a></li>
<li class="toctree-l3"><a class="reference internal" href="https://retroryan8080.gitlab.io/grpc-java-workshop/exercise5/deploykubernetes.html#verify-kubectl">Verify kubectl</a></li>
<li class="toctree-l3"><a class="reference internal" href="https://retroryan8080.gitlab.io/grpc-java-workshop/exercise5/deploykubernetes.html#explanation-by-ray-tsang-saturnism-https-twitter-com-saturnism">Explanation By Ray Tsang [@saturnism](https://twitter.com/saturnism)</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="https://retroryan8080.gitlab.io/grpc-java-workshop/exercise5/usingservices.html">Using Kubernetes Services</a></li>
<li class="toctree-l2"><a class="reference internal" href="https://retroryan8080.gitlab.io/grpc-java-workshop/exercise5/deployment.html">Kubernetes Deployment</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="https://retroryan8080.gitlab.io/grpc-java-workshop/exercise6/exercise6.html">Exercise 6 - Metadata and Interceptors</a></li>
<li class="toctree-l1"><a class="reference internal" href="https://retroryan8080.gitlab.io/grpc-java-workshop/exercise7/exercise7.html">Exercise 7 - Context Propagation</a></li>
<li class="toctree-l1"><a class="reference internal" href="https://retroryan8080.gitlab.io/grpc-java-workshop/exercise8/exercise8.html">Exercise 8 - Tracing</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="https://retroryan8080.gitlab.io/grpc-java-workshop/index.html">gRPC Chatroom Workshop</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="https://retroryan8080.gitlab.io/grpc-java-workshop/index.html">Docs</a> »</li>
        
          <li><a href="https://retroryan8080.gitlab.io/grpc-java-workshop/exercise5/exercise5.html">Exercise 5 - Deployment to Kubernetes</a> »</li>
        
      <li>Deploy a Kubernetes Cluster</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="https://retroryan8080.gitlab.io/grpc-java-workshop/_sources/exercise5/deploykubernetes.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="deploy-a-kubernetes-cluster">
<h1>Deploy a Kubernetes Cluster<a class="headerlink" href="https://retroryan8080.gitlab.io/grpc-java-workshop/exercise5/deploykubernetes.html#deploy-a-kubernetes-cluster" title="Permalink to this headline">¶</a></h1>
<div class="section" id="set-default-region-and-zones">
<h2>Set Default Region and Zones<a class="headerlink" href="https://retroryan8080.gitlab.io/grpc-java-workshop/exercise5/deploykubernetes.html#set-default-region-and-zones" title="Permalink to this headline">¶</a></h2>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">gcloud config set compute/zone us-central1-f</span>
<span class="go">gcloud config set compute/region us-central1</span>
</pre></div>
</div>
</div>
<div class="section" id="configure-your-default-project">
<h2>Configure your Default Project<a class="headerlink" href="https://retroryan8080.gitlab.io/grpc-java-workshop/exercise5/deploykubernetes.html#configure-your-default-project" title="Permalink to this headline">¶</a></h2>
<p>If you have multiple gcloud accounts then be sure the correct one is specified for the gcloud. You can get your default project id from the command line with:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">gcloud config get-value core/project</span>
</pre></div>
</div>
<p>If you are in an instructor led class with a provided credential, then you don’t need to set another project ID.</p>
<p>If you are not using an instructor provided credentials, then you may need to specify a project ID:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">gcloud config set project your-project-id</span>
</pre></div>
</div>
</div>
<div class="section" id="enable-compute-engine-and-kubernetes-engine-api">
<h2>Enable Compute Engine and Kubernetes Engine API<a class="headerlink" href="https://retroryan8080.gitlab.io/grpc-java-workshop/exercise5/deploykubernetes.html#enable-compute-engine-and-kubernetes-engine-api" title="Permalink to this headline">¶</a></h2>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">gcloud services enable \</span>
<span class="go">  compute.googleapis.com \</span>
<span class="go">  container.googleapis.com</span>
</pre></div>
</div>
</div>
<div class="section" id="create-a-kubernetes-cluster-using-the-google-kubernetes-engine">
<h2>Create a Kubernetes Cluster using the Google Kubernetes Engine<a class="headerlink" href="https://retroryan8080.gitlab.io/grpc-java-workshop/exercise5/deploykubernetes.html#create-a-kubernetes-cluster-using-the-google-kubernetes-engine" title="Permalink to this headline">¶</a></h2>
<p>Google Kubernetes Engine is Google’s hosted version of Kubernetes.</p>
<p>To create a container cluster execute:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">gcloud container clusters create chatworkshop \</span>
<span class="go">      --cluster-version=1.9.6-gke.1 \</span>
<span class="go">      --num-nodes 3 \</span>
<span class="go">      --machine-type n1-standard-2</span>
</pre></div>
</div>
<p>Retrieve your credentials for kubectl:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">gcloud container clusters get-credentials chatworkshop</span>
</pre></div>
</div>
<p>Grant cluster admin permissions to the current user (admin permissions are required to create the necessary RBAC rules for Istio).</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">kubectl create clusterrolebinding cluster-admin-binding \</span>
<span class="go">    --clusterrole=cluster-admin \</span>
<span class="go">    --user=$(gcloud config get-value core/account)</span>
</pre></div>
</div>
</div>
<div class="section" id="verify-kubectl">
<h2>Verify kubectl<a class="headerlink" href="https://retroryan8080.gitlab.io/grpc-java-workshop/exercise5/deploykubernetes.html#verify-kubectl" title="Permalink to this headline">¶</a></h2>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">kubectl version</span>
</pre></div>
</div>
</div>
<div class="section" id="explanation-by-ray-tsang-saturnism-https-twitter-com-saturnism">
<h2>Explanation By Ray Tsang [@saturnism](<a class="reference external" href="https://twitter.com/saturnism">https://twitter.com/saturnism</a>)<a class="headerlink" href="https://retroryan8080.gitlab.io/grpc-java-workshop/exercise5/deploykubernetes.html#explanation-by-ray-tsang-saturnism-https-twitter-com-saturnism" title="Permalink to this headline">¶</a></h2>
<p>This will take a few minutes to run. Behind the scenes, it will create Google Compute Engine instances, and configure each instance as a Kubernetes node. These instances don’t include the Kubernetes Master node. In Google Kubernetes Engine, the Kubernetes Master node is managed service so that you don’t have to worry about it!</p>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="https://retroryan8080.gitlab.io/grpc-java-workshop/exercise5/usingservices.html" class="btn btn-neutral float-right" title="Using Kubernetes Services" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="https://retroryan8080.gitlab.io/grpc-java-workshop/exercise5/setup.html" class="btn btn-neutral" title="Google Cloud Console Setup" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr>

  <div role="contentinfo">
    <p>
        © Copyright 2017, Ryan Knight, Ray Tsang.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org/">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../',
            VERSION:'',
            LANGUAGE:'None',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true,
            SOURCELINK_SUFFIX: '.txt'
        };
    </script>
      <script type="text/javascript" src="./exercise5-deploykubernetes_files/jquery.js.download"></script>
      <script type="text/javascript" src="./exercise5-deploykubernetes_files/underscore.js.download"></script>
      <script type="text/javascript" src="./exercise5-deploykubernetes_files/doctools.js.download"></script>

  

  <script type="text/javascript" src="./exercise5-deploykubernetes_files/theme.js.download"></script>

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 


</body></html>